var importantBrandNames =["zwan", "zuci", "zermisol", "zayka", "zandu", "za", "z", "yippee", "yardley", "yamamoto", "wrigley's", "wrigleys", "wow confetti", "woosh", "wonka", "woh hup", "wipro", "wild stone", "whole foods", "whitetone", "white castle", "whisper", "wheel", "werther's", "weikfield", "wawel", "walkers", "wagh bakri", "vwash", "vow", "voila", "vivel", "vintop", "vim", "village kitchen", "vi-john", "vijaya", "vicenzi", "vicco", "vega", "veg affaire", "veet", "vcare", "vasmol", "vaseline", "vasana", "vanish", "vandevi", "uttam", "utp", "unsnack!", "unilever", "unibic", "under the ocean", "under the mango tree", "uncle chipps", "ujala", "twizzlers", "twining's", "twinings", "twin birds", "tropicana", "trisa", "tops", "tootsie roll", "toonpops cartoon lollipops", "toni & guy", "tiptop", "tipiak", "tiparos", "tide", "tic-tac", "tic tac", "thums up", "threprin", "the pickle", "the nutty fruit house", "the green snack co.", "the gourmet", "the coffee bean & tea leaf®", "the bakers dozen", "thai", "tetley", "terzo", "temptations", "tempo", "tata tea", "tata sampann", "tata life", "tata i shakti", "tata gold", "tata agni", "tata", "tasty nibbles", "tariero", "tang", "talod", "taja", "taj mahal", "tai sun", "tago", "taffy town", "taaza", "syska", "swiss tempelle", "sweets", "sweetgourmet", "sweekar", "swati", "swastik", "swad", "svity", "surf excel", "surf", "sure", "supermax", "superia", "super vasmol", "sunsilk", "sunshine", "sunrise", "sunny", "sunfeast yumfills", "sunfeast pasta", "sunfeast farmlite", "sunfeast delishus", "sunfeast dark fantasy", "sunfeast biscuits", "sunfeast", "sundrop", "sunday", "sula", "sugarin", "sugar free", "streax", "steviocal", "stayfree", "star", "standeops", "standard", "st.ives", "sscpl herbals", "sri sri products", "sri sri ayurveda", "sri sri", "sri mandar hill", "sree devaa", "squarz", "spykar", "spring fest", "splitz", "spinz", "sparkmate", "spar fresh", "solimo", "solania", "sofy", "society", "soap opera", "snickers", "snackible", "sleek", "skittles", "skil", "sipahh", "sindhu", "simpkins", "signature snacks", "sidhivinyak", "shri", "shower to shower", "shoon fatt", "shangi", "shalimar", "sfp", "set wet", "sensodyne", "sensibly", "selpak", "secret temptation", "scotchguard", "scotch brite", "scholl", "schar", "savlon", "sapre", "santoor", "sanjeevani organics", "sanjeev kapoor's khazana", "sanjeev kapoor's", "sanifresh", "sani fresh", "sakthi", "sagar", "saffola gold", "saffola", "safewash", "safal", "sabena", "s j", "rustichella", "ruparel's", "ruchi", "royaal", "rosella", "roots", "rolson", "robo", "robin", "rizola", "ritebite", "riso", "rin", "ricela", "rexona", "revlon", "revive", "revital", "relin", "redondo", "red vines", "red label", "red bull", "real thai", "real", "rasoi magic", "rani", "rangeela", "ramdev masala", "ramdev", "ramchandra sahai", "ram bandhu", "rajnigandha", "ragivitta", "qvx", "queen", "quaker", "purix", "puresense", "pure & fresh", "punjab sind", "pucelle", "provogue", "protinex", "priyagold", "priya", "primio", "pril", "pride of india", "prestige", "premium harvest", "premium", "premier", "prego", "prabhat", "power house", "power", "popular essentials", "popmak", "poonjiajis", "ponds", "police", "playboy", "planet", "pitambari", "pingvin", "pimpom", "pim pom", "pillsbury", "piknik", "pigeon", "pietro", "piacelli", "phondaghat", "philips", "persil", "pepsodent", "peppy", "pegasus", "pears", "pearl", "patankar", "patanjali", "pasta zara", "pass pass", "paseo", "pasand", "parry's", "parrys", "parozone", "parle-g", "parle hide & seek", "parle", "park avenue", "parachute", "papilon food flavours & colours", "papilon flavours & food colours culinary essence (20 ml x 10 bottle)", "paper boat", "pantene", "panjwani", "palmolive", "palmers", "pallavi", "oxy", "oven brite", "oust", "original source", "origami", "oriental", "organica", "organic tattva", "organic origins", "organic india", "orbit", "oral b", "oosh", "ong's", "one man show", "omypop", "omega", "olivado", "oleeve", "oleev", "old spice", "olay", "oks", "ojasvita", "oh! nutsâ®", "odopic", "odonil", "odomos", "oceans secret", "ocean", "ob", "nyle", "nycil", "nyassa", "nyaasa", "nutty gritties", "nutrilite", "nutri value", "nutralite", "nutraj", "nutella", "nupur", "nufeel", "nourishyou", "noor", "nivea", "nissin", "nirmala", "nirma", "nilons", "nike", "nihar", "nestle pro-grow", "nestle nestum", "nestle nestogen", "nestle nan pro", "nestle milkmaid", "nestle lactogen", "nestle everyday", "nestle cerelac", "nestle baby & me", "nestle alpino", "nestlé", "nestle", "nestea", "nescafe gold", "nescafe drink", "nescafé", "nescafe", "neco", "nawab", "naturralle", "naturo", "naturesmith", "natures wonders", "naturals", "naturalcare", "natural fresh", "narasu's", "nandini", "mysore sandal", "my shaldan", "murginns", "munchy's", "munchys", "mukharochak", "mtr", "mrs.nayak", "mr.white", "mr namo", "mr muscle", "mountain dew", "motos", "moti", "mothers recipe", "mothers", "mother dairy", "mota", "mosqure", "mortein", "more", "monviso", "moha", "mister potato", "minute maid", "minto", "miltop", "miller", "millefoglie", "milky mist", "milkma", "milka", "mili", "microfaser", "mg", "mexitos", "meswak", "meron", "mentos", "medimix", "mediker", "mdh", "mcvities international", "mcvities", "mazaana", "maybelline", "maxo", "mason & co.", "marshmelts", "margo", "maniarrs", "manchy", "mamy", "mambalam iyers", "maltagliati", "malta", "maiyas", "mahi", "mahabhringraj", "maggi", "madam", "mackays", "m.h.k", "lyva", "luxeapers", "lux", "luft", "lozalo", "loreal", "looms & weaves", "loacker", "livon", "little tree", "little india", "little hearts", "listerine", "liril", "lipton ice tea", "lipton", "lion brand", "lion", "lime lite", "lijjat", "lifebuoy", "lexus", "lever ayush", "leong", "leonardo", "leo coffee", "leo", "lenor", "lehar", "lay's", "layer", "laxminarayan", "laxmi narayan", "laser", "lakshmi's gongura", "lakme", "lacto calamine", "l.g.", "kyphi", "kwality", "kvg", "kurkure namkeen", "kurkure", "ks", "krusteaz", "krrish", "kriti", "krisho hygiene pvt. ltd.", "krazy", "kopiko", "komal", "kohinoor", "knorr", "kleenomax", "kiwi", "kitchens treasures", "kitchens promise", "kitchens of india", "kissan", "kinley", "kims", "kilrock", "kia", "khushi", "keynote", "keya", "kettro", "kesh king", "kerk", "keo karpin", "kenny's", "kellogg's", "kelloggs", "kc das", "karmiq", "karma", "karachi bakery", "karachi", "kara", "kanshi", "kama sutra", "kale chips", "kagzi", "kadambari", "kabul di hatti", "kaarigari by kimmi", "k.harrodson", "k.c.das", "jyothy laboratories", "jyothi", "justrufs", "just destrooper", "just", "jungle magic", "jungle", "julies", "jules destrooper", "jubileu", "joy", "jovann", "jovan", "joogifts", "jolly ranchers", "jolen", "johnsons", "johnson & johnson", "johnson", "jo", "jns", "jinja motors", "jims", "jharna", "jeyes", "jet-puffed", "jes collection", "jelly belly", "jb traders", "jb", "jazz the chocolatier", "jayantilal", "jawahar", "japanese choice", "jalsa", "jalaram", "jaipur pride", "jain sabkuchh food plaza", "jags", "jaggi dry fruits (chandni chowk wale)", "jacques bogart", "jackson", "iyer's", "iyers", "iyengar", "iwill", "italos", "ital veloce", "istoredirect", "ispice", "isopure", "iris", "iraya", "involve your senses", "innovative", "innofresh max", "innofresh lite", "innofresh", "indus naturals", "indulgence", "indulge", "indulekha", "indispice", "indica", "indianuts.com", "indianuts", "indian queen basmati rice", "india gifts mall", "india gate", "indah", "ina paarman's", "ina paarmans", "imported", "imperial", "imagilane", "illy", "igb", "ifb", "idhayam", "idea printcity pvt ltd", "id fresh", "icing on top", "ibero", "hypercity every day", "hypercity", "hygi+", "hygi", "huober", "hundred years", "hudson", "household essentials", "horlicks", "honey twigs", "homemade chocobites", "home pride", "home chef", "home", "homchoc", "hoglatto", "hodgson mill", "hit", "hintz", "hindustan herbals", "himani", "himalayan brew", "himalaya", "hide and seek", "hi-chew", "hi choice", "hesh", "hershey's", "hersheys", "hershey", "hero", "herbs care", "herbins", "herbalife", "heracles", "henko", "hellmann's", "hellmanns", "helios", "heinz imported", "heinz", "heidi", "heena", "healthviva", "healthvit", "healthaid", "health on a platter", "head & shoulders", "he", "h-chew", "hawaiian host", "harpic", "harnik", "harmony", "harika", "happydent", "happilo", "hand made box", "hamam", "halwai sweets", "halls", "haldiram's prabhuji", "haldiram's nagpur", "haldiram's delhi", "haldiram's", "haldirams", "haldiram", "hakim", "haitai", "hair & care", "habin", "guruji", "gurujee", "gulabari", "guilt free snacking", "gubb", "gtee", "gs museum", "gruhini", "grisbi", "grenade", "greentech", "greensense", "green valley stevia", "green pearl", "green leopard", "green elements", "green dragon home solutions", "green dragon", "grb", "graney", "grandy", "grama", "gralit", "grain", "grace", "gowardhan", "gourmia", "gourmetco", "gouris", "googly", "goodwyn", "goodness", "good made", "good look", "good knight", "good home", "good eggs", "golden tips", "golden nut", "golden harvest", "gold winner", "gogi", "godya", "godrej protekt", "godrej no. 1", "godrej fairglow", "godrej", "godiva", "godblessu", "goana foods", "go nuts !!", "go bhaarati", "go & out", "gm", "glosil", "glam up", "glade", "gits", "giskaa", "ginger people", "gimbal's", "gillette", "giftstantra", "giftoria", "gifting matters", "giftacrossindia", "gift world", "gift island", "gift across india", "ghasitaram's", "ghasitaram gifts", "ghari", "getrim", "getbuyin", "getbuy", "germisol", "gerber", "georgia", "geol", "gentle", "genteel", "general mills cereals", "gele", "gee pee", "gebi", "gatsby", "gatorade", "gaspari nutition?", "garnier fructis", "garnier", "garden bliss", "garden", "ganpati", "gangaram rathi & co", "ganesh", "galaxy basmati rice", "galaxy", "galaji", "gala", "gaia", "g pulla reddy sweets", "fusion chocolates", "fusion", "funfoods", "fundoo", "fun mobile", "fun foods", "frutin's premium", "fruitz koncepts", "frostland", "froopops", "frix", "frito-lay", "frito lay", "frey", "fresno", "fresh-n-fresh", "freshcon", "fresh-choco store", "fresh valley", "fresh produce", "fresh ones", "fresh basket", "fresh & pure", "french", "freekal", "freedom foods", "freedom", "fragrantor's", "fragata", "foster's clark", "fortune", "formula", "foody fusion", "foodecor", "food studio", "fogg", "fluid", "flower n ferns", "floret", "floral mall", "flora online", "flat tummies", "flamingo air freshener", "flaberry", "firstloot", "first smart deal", "firaki", "finish", "fini", "finger lix", "fine blossom", "figaro", "fiestas chocolates", "fiesta bread", "fiama di wills", "ferrero rocher", "ferns n petals", "ferme naturelle", "fem", "feel fresh", "febreze", "feasters", "fazlani", "faultless", "fashion perfume", "farrell", "farm's secret", "farm naturelle", "fancy centre", "falero", "falcon", "fairy chocolates", "fairy", "fairever", "fair & lovely", "fabric magic", "fab 360", "ezee", "extra kleen", "exquise chocolates", "exotica", "exotic flavors of india", "exo", "excel plus", "everyuth", "everyday gifts", "everyday", "everest", "eveready", "evaflor", "eva", "euro", "esn", "epicure", "envy", "enliven", "english oven", "engage", "enfamil", "energy", "endura", "encona", "enchanteur", "emperor", "emoform-r", "embrace choclates", "emami", "elle", "elizabeth shaw", "elemis", "ekom", "ekgaon one village one world network", "ekgaon", "egzo", "e-fab", "edens tea", "eco star", "eat o", "easy clean", "easy", "eastern", "eagle", "dynamix", "dylon", "dwarka sweets", "dvine", "duzzit", "duracell", "duomo", "dukes", "duc do", "duc d'o", "dryfruit basket", "dryfal", "drop2clean", "dream", "dr.scholls", "dr.marcus", "dr scholls", "dr fresh", "doy care", "dove", "double horse", "doodh misthan bhandar", "domex", "dns", "dnd", "divinutty", "divinite", "divine.", "diva", "dishmatic", "diponed unica", "diponed", "diet foods", "diabodelite", "dhrumil", "dhathri", "dharani", "dhanshri", "dhan laxmi", "d'free", "dff", "dev", "dettol", "desire", "desi chocolates", "dermoviva", "dermi cool", "deoji ganpat", "denver", "dento shine", "demerara", "delverde", "delta solution", "delinut", "delight nuts", "delight foods", "delight food", "delight", "delicious", "delica by swarn chocolates", "deli sun", "del monte", "deccan", "de'arco chocolatier", "dd and co.", "dcc delicious", "dcc", "dc dry fruit box", "davidoff imported", "davidoff cafe", "davidoff", "date crown", "dash", "danone", "dangayach products", "dana", "daksh arts", "dairy home", "daily diet", "dabur", "daawat", "daadi's", "daadis", "cvm", "crystal", "crown", "crespi", "cremica", "creative candles", "crave eatables", "crabtree and evelyn", "crabtree & evelyn", "courtney's candles", "cotton mist", "cothas", "costa", "cosmetrix", "cornitos", "copenhagen", "coombs family farms", "cool cool", "cool & cool", "cookme", "cookieman", "cookie man", "convex", "continental", "conscious food", "conscious", "connoisseur selection", "confectionery,choco&dessert", "concord", "comfort", "colonel & co", "colman's", "colmans", "colin", "colgate", "colavita", "coffee day", "cocosutra", "cocopure", "cocobites", "cocoacraft", "cocoa world", "cocoa", "coco care", "cloud tech", "close up", "clorox", "clipper", "clinic plus", "click germ protector", "clenz u", "clear", "cleanmax", "clean out", "clean n fresh", "clean n dry", "clean & clear", "clean & clear", "clarus", "citylife", "city hardware and trading", "cirio", "cinthol", "cif", "chymey", "chupa chups", "chupa chupa", "chokola", "chokhi dhani", "choice", "chocoworld", "chocoville", "chocotreat chocolates", "chocopost", "choconuts", "chocomishty", "chocomania", "chocolover", "chocolicious", "chocolato", "chocolatiers-the chocolate boutique", "chocolatemantra", "chocolatemaker", "chocolate temptation", "chocolate gifting box", "chocolate factory", "chocolate", "chocolade", "chocohub", "chocofly", "chocofarm", "chocoblessings", "chocobites", "chocobang", "chocoasm", "chocoaffairzz", "choco treats", "choco shade", "choco obsession", "choco masti", "choco creation", "choc-in the-box", "chocholik", "choc of the town", "choc it", "choc coin", "chitle", "chitale's redolence", "chitale", "chirton", "ching's secret", "chings", "chimes", "chicken tonight", "chevys chocolates", "chetan", "cherir", "chef's basket", "chefs basket", "cheetos", "cheedas", "chataka", "chandu", "chandrika", "chaang", "cglow", "cg herbals", "cero", "center fresh", "celebrations", "celebrate health", "cee pee", "catchin24", "catch", "carrolite", "carpel", "carnival of glee creations", "carnival", "carefree", "cardia", "capsico", "capilano", "cantina", "canpop", "candymax", "candyman", "candylicious", "candy clouds", "camel", "calvo", "california sunshine cafe", "california scents", "calgon", "caldrea", "cake studio", "caffarel", "cafedesire", "café desire", "cafe desire", "cadburys", "cadbury oreo", "cadbury dairy milk", "cadbury celebrations", "cadbury", "c4", "by nature", "bvc", "butterfly", "buffet", "budweiser", "btm septic", "brylcreem", "brut", "bru", "brown & haley", "britannia", "brio", "bright cove", "breadkraft", "bragg", "bournvita", "boroluxâ®", "boro plus", "borges", "bonne maman", "bonn", "bombones", "bogatchi", "bodyguard", "bob's red mill", "bobs red mill", "bluecross", "blue ocean designs", "blue elephant", "blue diamond", "blue bird", "bloo", "bliss", "blazon", "black tie mercantile", "black rose", "black & white", "bittus", "bisto", "biskotto", "birla morton", "bio-doze", "bio oil", "bingo", "bindu", "bila", "bikano", "bikanervala", "bikaji", "biggles", "bigen", "big d", "bhavnagri", "bharat ki dukan", "bha", "bh wood gallery", "bgrows", "beverly hills", "betty crocker", "betco", "besure", "best", "benetton", "bella", "belgian", "beldi", "beelicious", "beekays", "beehive farms", "bee the change", "beconscious", "be -grin", "bdel", "bblunt", "bayars coffee", "bath fantasy", "bath & body works", "basilur", "baron", "barilla", "baria", "bare essentials", "bansiwala", "banne nawab's", "banjaras", "bambino", "balaji", "bakewala", "bakers boy", "baker street", "bake smith", "bake and sweet house", "bajaj", "baidyanath", "bagrry's", "bagrrys", "badshah", "badhusha lazeez pickles", "badhusha lazeez", "bacter", "baba ramdev patanjali", "b natural", "azad", "ayam", "axion", "axe", "avt", "avm associates", "avf", "aveno cafã©", "automatic thumb", "aura cacia", "atlas marketing services", "athena", "atak air", "aswini", "astonish", "asthetika", "asr", "asian delight", "asha", "asal", "as chef cook", "arya farm", "arul appalam", "artisan", "artique", "arora", "aromatree", "aromablendz", "aroma treasures", "arihant", "ariel", "areon", "archies", "aramusk", "apollo pharmacy", "apis", "apical crafts", "apexa dry fruits", "apex nuts", "a-one", "antarkranti", "anne french", "anna and sarah", "anmol dry fruits", "anjlika foods", "angry birds aospicious", "angelitos", "android", "and retails", "anchor", "anant", "anandam", "amway", "amulya", "amul", "amritsari", "ammi samayal", "amit", "amira organic", "amira", "amhor", "american garden", "american bouquet", "ambipur", "ambi pur.", "ambi pur", "ambari", "amaze fashion studio", "amaretti", "amar", "amals", "alpenliebe", "almendrop", "ally", "allwin stores", "allout", "alliance", "all out", "alfredo", "al kabeer", "akshaya", "aksh enterprise", "akar", "aiteli", "airwick", "airance", "air wick", "air show", "air pure", "ahuja bakers", "agro fresh", "agnesi", "aggarwal sweets and gift", "afp", "aerosoul", "aeroplane basmati", "aeroplane", "aero soul", "aer", "adfs", "aden fresh", "adeez", "ad 1985 chocolates", "act ii", "accessory innovations", "abzorb - it", "absorbia", "abs", "abhishek malik", "abbie's", "abbies", "aazad mithai", "aashram", "aashirvaad ready to eat", "aashirvaad", "aarcay", "aanya", "aadya creations", "aadhar", "aachi", "a4 chocolate", "a2b", "a1", "a&s", "a la naturelle", "7up", "7th heaven", "777", "5a", "5 cees", "3roses", "3 roses", "24 mantra organic", "24 mantra"]


var parsingRules = [{
		urlRegexContains: ".*amazon.*dp.*",
		titleContainsArray: ["Amazon.in"],
		productName: {
			"htmlId": "#productTitle",
			"objectKey": "innerText"
		},
		productBrandName: {
			"htmlId": "#brand",
			"objectKey": "innerText"
		},
		productMrpPrice: {
			"htmlId": "#dpv2_redesign_strikeprice_and_savings_row,strike[id='priceblock_ourprice'],span[class='a-text-strike']",
			"objectKey": "innerText"
		},
		productOfferPrice: {
			"htmlId": "#dpv2_redesign_priceblock_priceToPay,#priceblock_saleprice,span[id='priceblock_ourprice']",
			"objectKey": "innerText"
		},
		productDealPrice: {
			"htmlId": "#priceblock_dealprice",
			"objectKey": "innerText"
		},
		productImage: {
			"htmlId": "img[id='landingImage']",
			"objectKey": "src"
		},
		productDbId: {
			"htmlId": "#ASIN",
			"objectKey": "value"
		},
		productUrlId: {
			"htmlId": "#ASIN",
			"objectKey": "value"
		},
		PartnerName: "Amazon"
	},
	
	{
		//http://www.bigbasket.com/pd/267054/dettol-bathing-soap-original-75-gm/
		urlRegexContains: ".*bigbasket.*/pd/.*",
		titleContainsArray: [""],
		//<h1> Dettol Bathing Soap - Original, 75 gm ( Pack of 3 ) </h1>
		productName: {
			"htmlId": "h1",
			"objectKey": "innerText"
		},
		//<div class="uiv2-brand-name"><a href="/pb/dettol/"> DETTOL </a></div>
		productBrandName: {
			"htmlId": "div[class='uiv2-brand-name']",
			"objectKey": "innerText"
		},
		//<span id="uiv2-mrp"><hr>MRP: Rs. 79.00</span>
		productMrpPrice: {
			"htmlId": "span[id='uiv2-mrp']",
			"objectKey": "innerText"
		},
		//<div class="uiv2-price" itemprop="price"> Rs. 75.05</div>
		productOfferPrice: {
			"htmlId": "div[class='uiv2-price']",
			"objectKey": "innerText"
		},
		productDealPrice: {
			"htmlId": "",
			"objectKey": "innerText"
		},
		//<img itemprop="image"
		productImage: {
			"htmlId": "img[itemprop='image']",
			"objectKey": "src"
		},
		//<input type="hidden" id="id-product-id" value="267054">
		productDbId: {
			"htmlId": "input[id='id-product-id']",
			"objectKey": "value"
		},
		productUrlId: {
			"htmlId": "input[id='id-product-id']",
			"objectKey": "value",
		},
		PartnerName: "BigBasket"
	},
	
		{
		urlRegexContains: ".*mymorestore.*p.php",
		titleContainsArray: [""],
		//h1 itemprop="name"
		productName: {
			"htmlId": "h1[itemprop='name']",
			"objectKey": "innerText"
		},
		//<span itemprop="name">Himalaya</span>
		productBrandName: {
			"htmlId": "span[itemprop='name']",
			"objectKey": "innerText"
		},
		//<span class="js-mrp">50.00</span>
		productMrpPrice: {
			"htmlId": "span[class='js-mrp']",
			"objectKey": "innerText"
		},
		//<h2 class="finalPrice">? 169.50</h2>
		productOfferPrice: {
			"htmlId": "h2[class='finalPrice']",
			"objectKey": "innerText"
		},
		productDealPrice: {
			"htmlId": "",
			"objectKey": "innerText"
		},
		//<img class="js-item-image" itemprop="image" src="https://p2.mymorestore.com/images/products/320/terzo-window-wiper-86-gm-3381-v-1-pc.png" alt="Terzo Window Wiper 86 Gm 3381 1 pc">
		productImage: {
			"htmlId": "img[itemprop='image']",
			"objectKey": "src"
		},
		//<div class="itemLeft jsProduct" data-status="ENABLED" data-display="detail" data-item-id="12521" 
		//$(domHtml).find("div[class='itemLeft jsProduct']")[0]['attributes']["data-item-id"]['nodeValue']
		//<meta itemprop="productId" content="10004935">
		productDbId: {
			"htmlId": "meta[itemprop='productId']",
			"objectKey": "content"
		},
		productUrlId: {
			"htmlId": "",
			"objectKey": "",
			"urlReplace": "https://www.mymorestore.com/"
		},
		PartnerName: "MyMoreStore"
	},
	
	{
		urlRegexContains: ".*zopnow.*p.php",
		titleContainsArray: [""],
		//h1 itemprop="name"
		productName: {
			"htmlId": "h1[itemprop='name']",
			"objectKey": "innerText"
		},
		//<span itemprop="name">Himalaya</span>
		productBrandName: {
			"htmlId": "span[itemprop='name']",
			"objectKey": "innerText"
		},
		//<span class="js-mrp">50.00</span>
		productMrpPrice: {
			"htmlId": "span[class='js-mrp']",
			"objectKey": "innerText"
		},
		//<h2 class="finalPrice">₹ 169.50</h2>
		productOfferPrice: {
			"htmlId": "h2[class='finalPrice']",
			"objectKey": "innerText"
		},
		productDealPrice: {
			"htmlId": "",
			"objectKey": "innerText"
		},
		//<img class="js-item-image" itemprop="image" src="https://p2.zopnow.com/images/products/320/terzo-window-wiper-86-gm-3381-v-1-pc.png" alt="Terzo Window Wiper 86 Gm 3381 1 pc">
		productImage: {
			"htmlId": "img[itemprop='image']",
			"objectKey": "src"
		},
		//<div class="itemLeft jsProduct" data-status="ENABLED" data-display="detail" data-item-id="12521" 
		//$(domHtml).find("div[class='itemLeft jsProduct']")[0]['attributes']["data-item-id"]['nodeValue']
		//<meta itemprop="productId" content="10004935">
		productDbId: {
			"htmlId": "meta[itemprop='productId']",
			"objectKey": "content"
		},
		productUrlId: {
			"htmlId": "",
			"objectKey": "",
			"urlReplace": "https://www.zopnow.com/"
		},
		PartnerName: "ZopNow"
	},
	
	{
		urlRegexContains: ".*snapdeal.*/product/.*/[0-9]*.*",
		titleContainsArray: ["Snapdeal"],
		productName: {
			"htmlId": "h1[class='pdp-e-i-head']",
			"objectKey": "innerText"
		},
		//<li class="col-xs-8 dtls-li">
		productBrandName: {
			"htmlId": "li[class='col-xs-8 dtls-li']",
			"objectKey": "innerText",
			"containString": "Brand : "
		},
		productMrpPrice: {
			"htmlId": "div[class='pdpCutPrice'],span[class='payBlkBig']",
			"objectKey": "innerText"
		},
		productOfferPrice: {
			"htmlId": "span[itemprop='price']",
			"objectKey": "innerText"
		},
		productDealPrice: {
			"htmlId": "",
			"objectKey": "innerText"
		},
		productImage: {
			"htmlId": "img[itemprop='image']",
			"objectKey": "src"
		},
		productDbId: {
			"htmlId": "#productId",
			"objectKey": "value",
			"urlParameter": ""
		},
		productUrlId: {
			"htmlId": "#productId",
			"objectKey": "value",
			"urlParameter": ""
		},
		PartnerName: "Snapdeal"
	}
];

function matchOtherRules(domHtml, otherRules) {
	if(!otherRules) return true;
	for (var i = 0; i < otherRules.length; i++) {
		var valueString = getValueByXpath(domHtml, otherRules[i].htmlId, otherRules[i].objectKey);
		if (valueString.indexOf(otherRules[i].containString) === -1) {
			return false;
		}
	}
	return true;
}

function getBrandName(domHtml, elementObject, productName){
	var productBrandName = getElementByXpath(domHtml, elementObject);
	if(productBrandName) {
		if(elementObject.containString){
			return productBrandName.replace(elementObject.containString, "");
		}else{
		return productBrandName;
		}
	}
	for (var i = 0; i < importantBrandNames.length; i++) {
		var brandName = importantBrandNames[i];
		brandName = brandName.toLowerCase();
		brandName = brandName.replace(/[^a-z 0-9]/g, '');
		var productNameString = productName.toLowerCase().replace(/[^a-z 0-9]/g, '');
		brandName = "\\b"+brandName+"\\b";
		var brandNameRegex = new RegExp(brandName);
		if (brandNameRegex.test(productNameString)) {
			return importantBrandNames[i];
		} 
	}
	return null;
}

var getQueryString = function ( field, url ) {
    var href = url ? url : window.location.href;
    var reg = new RegExp( '[?&]' + field + '=([^&#]*)', 'i' );
    var string = reg.exec(href);
    return string ? string[1] : null;
};

function getProductId(domHtml, elementObject, url){
if(elementObject.htmlId){
return getElementByXpath(domHtml, elementObject);
}
if(elementObject.urlParameter){
return getQueryString(elementObject.urlParameter, url);
}
if(elementObject.urlReplace){
var href = url ? url : window.location.href;
return href.replace(elementObject.urlReplace, "");
}
return null;
}

function parseSite(url, title, domHtml) {
	for (var i = 0; i < parsingRules.length; i++) {
		if (urlMatch(url, parsingRules[i].urlRegexContains) && titleMatch(title, parsingRules[i].titleContainsArray) && matchOtherRules(domHtml, parsingRules[i].otherRules)) {
			
			var productName = getElementByXpath(domHtml, parsingRules[i].productName);
			if (productName === null)
				return null;
			
			var productBrandName = getBrandName(domHtml, parsingRules[i].productBrandName, productName);
			if(productBrandName=== null || importantBrandNames.indexOf(productBrandName.toLowerCase()) === -1)
				return null;
						
			var productDbId = getProductId(domHtml, parsingRules[i].productDbId, url);
			if (productDbId === null)
				return null;

			var productUrlId = getProductId(domHtml, parsingRules[i].productUrlId, url);
			if (productUrlId === null)
				return null;

			var productMrpPrice = getElementByXpath(domHtml, parsingRules[i].productMrpPrice);
			var productOfferPrice = getElementByXpath(domHtml, parsingRules[i].productOfferPrice);
			var productDealPrice = getElementByXpath(domHtml, parsingRules[i].productDealPrice);
			var productImage = getElementByXpath(domHtml, parsingRules[i].productImage);
			productImage = productImage.replace("chrome-extension", "http");
			
			var productMetadata = {
				ProductName: productName,
				ProductDbId: productDbId,
				ProductUrlId: productUrlId,
				ProductMrpPrice: productMrpPrice,
				ProductOfferPrice: productOfferPrice,
				ProductDealPrice: productDealPrice,
				ProductImage: productImage,
				ProductBrandName: productBrandName,
				PartnerName: parsingRules[i].PartnerName,
				Link: url,
			}

			return productMetadata;
		}

	}
	return null;
}

function titleMatch(title, titleContainsArray) {
	for (var i = 0; i < titleContainsArray.length; i++) {
		if (title.indexOf(titleContainsArray) !== -1) {
			return true;
		}
	}
	return false;
}

function urlMatch(urlString, urlRegex) {
	var urlRegexContains = new RegExp(urlRegex);
	if (urlRegexContains.test(urlString)) {
		return true;
	} else {
		return false;
	}
}

function getValueByXpath(domHtml, htmlId, htmlAttribute) {
	if(!domHtml || !htmlId || !htmlAttribute)
	return null;
	var element = $(domHtml).find(htmlId);
	if (element[0] != null) {
		var elementValue = getAttributeByXpath(element, htmlAttribute);
		if (elementValue) {
			elementValue = elementValue.trim();
			elementValue = elementValue.replace(/(\r\n|\n|\r)/gm, "");
			elementValue = elementValue.replace(/(MRP:|MRP|Rs[.]|Rs|₹)/gm, "");
			elementValue = elementValue.trim();
			return elementValue;
		}
	}
	return null;
}

function getAttributeByXpath(elementArray, htmlAttribute){
	if(htmlAttribute instanceof Array){
		var elementObject = elementArray[0];
		for(var i=0;i<htmlAttribute.length;i++){
		elementObject=elementObject[htmlAttribute[i]];
		}
		return elementObject;
	}else{
		return elementArray[0][htmlAttribute];
	}
}

function getElementByXpath(domHtml, elementObject) {
	if(!elementObject)
	return null;
	return getValueByXpath(domHtml, elementObject.htmlId, elementObject.objectKey);
}
